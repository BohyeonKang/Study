## Chapter 1. 베이즈 이론

챕터 1에서는 베이즈 이론에 대한 간략한 설명 및 3가지 예제를 들고 그 풀이를 보여줍니다.

#### 쿠키 문제

2개의 쿠키 그릇이 있다.
첫 번째 그릇에는 바닐라 쿠키 30개와 초콜렛 쿠키 10개가 있고,
두 번째 그릇에는 두 가지 쿠키가 20개씩 있다.

어떤 그릇인지 보지 않고 임의로 1개의 쿠키를 집었는데 바닐라 쿠키였다.
그렇다면 그릇1에서 나왔을 가능성은 ?

- P(B1) : 그릇 1에서 뽑을 확률 (1/2)
- P(B2) : 그릇 2에서 뽑을 확률 (1/2)
- P(V) : 바닐라 쿠키를  뽑을 확률 ((1/2) * (3/4) + (1/2) * (2/4) = 3/8 + 2/8 = 5/8)

```
P(V) * P(B1|V) = P(B1) * P(V|B1)

P(B1|V) = P(B1) * P(V|B1) / P(V)
        = (1/2) * (3/4) / 5/8
        = 3/5
```

#### M&M 문제

1995년 이전의 M&M 봉지에는 갈색 30%, 노랑 20%, 빨강 20%, 녹색 10%, 주황 10%, 황갈색 10%가 들어있었다.
이후에는 파란색이 추가되어 파랑 24%, 녹색 20%, 주황 16%, 노랑 14%, 빨강 13%, 갈색 14%가 되었다.
한 친구가 M&M을 두 봉지 샀는데 각각 1994, 1996년에 생산된 것이었다.
각 봉지에서 하나씩 꺼냈을 때 한 알은 노랑색이고 한 알은 녹색이었다.
이때 노랑 초콜렛이 1994년에 생산한 봉지에서 나올 확률은 ?

- M4 : 1994년 봉지를 고를 확률 (1/2)
- M6 : 1996년 봉지를 고를 확률 (1/2)
- P(Y4) = P(Y|M4) : 1994년 봉지에서 노랑을 고를 확률 0.2
- P(Y6) = P(Y|M6) : 1996년 봉지에서 노랑을 고를 확률 0.14
- P(G4) = P(G|M4) : 1994년 봉지에서 녹색을 고를 확률 0.1
- P(G6) = P(G|M6) : 1994년 봉지에서 녹색을 고를 확률 0.2

각 봉지에서 노랑과 녹색을 하나씩 고를 확률은 각 봉지에서 해당 색을 고를 확률을 더하면 됨.

```
P(YG) = P(Y|M4) * P(G|M6) + P(G|M4) * P(Y|M6)
      = 0.2 * 0.2 + 0.1 * 0.14
      = 0.04 + 0.014
      = 0.054
```

그럼 여기에 베이지안 정리를 적용하면

```
P(YG) * P(Y4|YG) = P(Y4) * P(YG|Y4)

P(Y4|YG) = P(Y4) * P(YG|Y4) / P(YG)
         = 0.2 * P(G6) / 0.054
         = 0.2 * 0.2 / 0.054
         = 0.04 / 0.054
         = 20/27 
```

정답은 `20/27`

하지만 책이나 대부분의 다른 곳(ex. <http://www.ecogwiki.com/Bayes_theorem> )에서는 다른 방법으로 풀이를 했음. 

조금 쉽게 풀이하자면

1. 가설을 나눠서 각각의 확률을 구함. (A, B)
2. 그 확률의 합을 전체 일어날 확률로 가정. P(D)
3. A 혹은 B의 확률을 P(D)로 나누면 원하는 값을 구할 수 있음

- 가설 A : Y가 M4에서 나왔고, G가 M6에서 나왔을 경우
- 가설 B : Y가 M6에서 나왔고, G가 M4에서 나왔을 경우

- P(H) * P(D|H)
  - P(A) : P(Y4) * P(G6) = 0.2 * 0.2 = 0.04
  - P(B) : P(Y6) * P(G6) = 0.14 * 0.1 = 0.014
- P(D) = P(A) + P(B) = 0.04 + 0.014

그러므로

- P(H|D) = P(H) * P(D|H) / P(D)
  - 가설 A : 20/27
  - 가설 B :  7/27

#### 몬티 홀 문제

- 3개의 문 중 1개에만 비싼 자동차가 있으며, 나머지는 저가 상품임
- A, B, C 중 1개의 문을 선택함 (A라 가정)
- 선택되지 않은 2개 중 자동차가 없는 문열 열어서 보여줌 (C라 가정)
- 처음 선택한 문(A)을 계속 고수할 것인지 아직 보여지지 않은 문(B)으로 바꿀지 선택하라고 함
- 선택을 고수하는 것과 바꾸는 것은 아무런 차이가 없을까 ?

제가 문제를 푼 방법은...

- P(A) : 처음 자동차를 뽑을 확률 = 1/3
- P(~A) : 처음 자동차를 뽑지 못할 확률 = 2/3
- 처음 자동차를 뽑았을 경우
  - P(S|A) : 계속 고수해서 뽑을 확률 = 1/3
  - P(M|A) : 바꿀 경우 = 0
- 처음에 자동차를 못 뽑았을 경우
  - P(S|~A) : 계속 고수할 경우 = 0
  - P(M|~A) : 바꿔서 뽑을 확률 = 2/3

수치적으로는 이렇게 계산이 되는데, 마지막에 바꾸는 것에 대해서는 1/2로 각각 확률이 같다고 하지만,
- 먼저 뽑은게 정답일 확률이 1/3 인데 거기서는 고수해야 계속 정답인 것이고,
- 먼저 뽑은게 정답이 아닐 확률이 2/3 인데 거기서는 바꿔야 정답인 것이기 때문에
결과적으로는 바꿔서 정답일 확률이 2/3 이라는 좀 의하한 결과가 됨.

책에서 설명하는 `실사법`은 다음 링크를 보는게 더 이해가 쉽다.
- <https://ko.wikipedia.org/wiki/몬티_홀_문제>





